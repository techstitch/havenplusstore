<ul class="widget-list">
  <li class="payment-method-widget tamara-widget">
    <img 
      src="https://cdn.dsmcdn.com/mobile/international/PaymentLogo/tamara-payment-en.png" 
      class="widget-logo" 
      alt="Tamara" 
    >
    <div class="widget-message-container">
      <p class="message">
        Pay up to <span>4</span> interest-free payments starting from 
        <strong class="installment-amount">
          {{ product.selected_or_first_available_variant.price | divided_by: 4.0 | money }}
        </strong>.
      </p>
      <span class="widget-chevron"></span>
    </div>
  </li>

  <li class="payment-method-widget tabby-widget">
    <img 
      src="https://cdn.dsmcdn.com/mobile/international/PaymentLogo/tabby-payment-en.png" 
      class="widget-logo" 
      alt="Tabby"
    >
    <div class="widget-message-container">
      <p class="message">
        Pay in <span>4</span> interest-free payments of 
        <strong class="installment-amount">
          {{ product.selected_or_first_available_variant.price | divided_by: 4.0 | money }}
        </strong>.
      </p>
      <span class="widget-chevron"></span>
    </div>
  </li>
</ul>

<style>
  .widget-list {
    display: flex;
    gap: 16px;
    list-style: none;
    padding: 0;
    margin: 0 0 20px 0;
  }

  .payment-method-widget {
    flex: 1;
    display: flex;
    align-items: center;
    border: 1px solid #ddd;
    border-radius: 12px;
    padding: 12px 16px;
    background: #fff;
    cursor: pointer;
    transition: box-shadow 0.2s ease;
  }

  .payment-method-widget:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  .tamara-widget {
    border-color: #ffa500;
  }

  .tabby-widget {
    border-color: #3bff9d;
  }

  .widget-logo {
    width: 50px;
    height: auto;
    margin-right: 12px;
  }

  .widget-message-container {
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .message {
    font-size: 14px;
    color: #333;
    margin: 0;
    max-width: 95%;
  }

  .widget-chevron {
    display: inline-block;
    width: 12px;
    height: 12px;
    mask-image: url('https://cdn.dsmcdn.com/sfint/production/chevron-right_1708355355014.svg');
    mask-size: cover;
    background-color: #333;
  }

  @media(max-width:756px){
    .widget-list { flex-direction: column; }
  }
</style>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const widgets = document.querySelectorAll(".payment-method-widget");

  widgets.forEach(widget => {
    widget.addEventListener("click", function() {
      // Variant from Liquid (ensures current PDP product is targeted)
      const variantId = {{ product.selected_or_first_available_variant.id }};
      // Get PDP quantity input, fallback to 1
      const qtyInput = document.querySelector("form[action^='/cart/add'] [name='quantity']");
      const qty = qtyInput ? qtyInput.value : 1;
      // Redirect directly to checkout
window.location.href = `/checkout?variant=${variantId}&quantity=${qty}`;
    });
  });
});
</script>

{% schema %}
{
  "name": "Tamara Tabby",
  "settings": [
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    }
  ],
  "presets": [
    {
      "name": "Tamara Tabby"
    }
  ]
}
{% endschema %}
