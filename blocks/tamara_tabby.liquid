<ul class="widget-list">
  <li 
    class="payment-method-widget tamara-widget"
    onclick="addAndCheckout({{ product.selected_or_first_available_variant.id }})"
  >
    <img 
      src="https://cdn.dsmcdn.com/mobile/international/PaymentLogo/tamara-payment-en.png" 
      class="widget-logo" 
      alt="Tamara" 
    >
    <div class="widget-message-container">
      <p class="message">
        Pay up to <span>4</span> interest-free payments starting from 
        <strong>{{ product.selected_or_first_available_variant.price | divided_by: 4.0 | money }}</strong>.
      </p>
      <span class="widget-chevron"></span>
    </div>
  </li>

  <li 
    class="payment-method-widget tabby-widget"
    onclick="addAndCheckout({{ product.selected_or_first_available_variant.id }})"
  >
    <img 
      src="https://cdn.dsmcdn.com/mobile/international/PaymentLogo/tabby-payment-en.png" 
      class="widget-logo" 
      alt="Tabby"
    >
    <div class="widget-message-container">
      <p class="message">
        Pay in <span>4</span> interest-free payments of 
        <strong>{{ product.selected_or_first_available_variant.price | divided_by: 4.0 | money }}</strong>.
      </p>
      <span class="widget-chevron"></span>
    </div>
  </li>
</ul>

<script>
function addAndCheckout(variantId) {
  fetch('/cart/add.js', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ id: variantId, quantity: 1 })
  })
  .then(() => {
    window.location.href = '/checkout';
  })
  .catch(err => console.error('Error adding to cart:', err));
}
</script>


<style>
  .widget-list {
    display: flex;
    gap: 16px;
    list-style: none;
    padding: 0;
    margin: 0 0 20px 0;
  }

  .payment-method-widget {
    flex: 1;
    display: flex;
    align-items: center;
    border: 1px solid #ddd;
    border-radius: 12px;
    padding: 12px 16px;
    background: #fff;
    cursor: pointer;
    transition: box-shadow 0.2s ease;
  }

  .payment-method-widget:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  .tamara-widget {
    border-color: #ffa500;
  }

  .tabby-widget {
    border-color: #3bff9d;
  }

  .widget-logo {
    width: 50px;
    height: auto;
    margin-right: 12px;
  }

  .widget-message-container {
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .message {
    font-size: 14px;
    color: #333;
    margin: 0;
    max-width: 95%;
  }

  .widget-chevron {
    display: inline-block;
    width: 12px;
    height: 12px;
    mask-image: url('https://cdn.dsmcdn.com/sfint/production/chevron-right_1708355355014.svg');
    mask-size: cover;
    background-color: #333;
  }

  @media(max-width:756px){
    .widget-list {
      flex-direction: column;
    }
  }
</style>

{% schema %}
{
  "name": "Tamara Tabby",
  "tag": null,
  "settings": [
    {
      "type": "product",
      "id": "product",
      "label": "t:settings.product"
    }
  ],
  "presets": [
    {
      "name": "Tamara Tabby",
      "settings": {
        "product": "{{ closest.product }}"
      }
    }
  ]
}
{% endschema %}
