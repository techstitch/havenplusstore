{% comment %}
------------------------------------------------------------
IMPORTANT: The contents of this file are generated.
Please exercise caution as any changes made to this file may be overwritten.
------------------------------------------------------------
{% endcomment %}

{% assign s = section.settings %}
{% assign metafield = shop.metafields.essential_loyalty.landing_page.value %}
{% assign customer_json = customer.metafields.essential_loyalty.landing_page.value | json %}

<style>
  :root {
    --essential-heading-font-family: {{ s.heading_font_family }};
    --essential-text-font-family: {{ s.text_font_family }};
    --essential-heading-color: {{ s.heading_color }};
    --essential-text-color: {{ s.text_color }};
    --essential-page-background-color: {{ s.page_background_color }};
    --essential-page-max-width: {{ s.page_max_width }}px;
    --essential-border-radius: {{ s.border_radius }}px;
    --essential-heading-font-size: {{ s.heading_font_size }}px;
    --essential-text-font-size: {{ s.text_font_size }}px;
    --essential-heading-font-size-mobile: {{ s.heading_font_size_mobile }}px;
    --essential-text-font-size-mobile: {{ s.text_font_size_mobile }}px;

    --essential-button-background-color: {{ s.button_background_color }};
    --essential-button-text-color: {{ s.button_text_color }};
    --essential-button-hover-background-color: {{ s.button_hover_background_color }};
    --essential-button-hover-text-color: {{ s.button_hover_text_color }};
    --essential-button-border-color: {{ s.button_border_color }};
    --essential-button-font-size: {{ s.button_font_size }}px;
    --essential-button-padding-x: {{ s.button_padding_x }}px;
    --essential-button-padding-y: {{ s.button_padding_y }}px;

    --essential-input-background-color: {{ s.input_background_color }};
    --essential-input-text-color: {{ s.input_text_color }};
    --essential-input-border-color: {{ s.input_border_color }};
    --essential-input-font-size: {{ s.input_font_size }}px;
    --essential-input-padding-x: {{ s.input_padding_x }}px;
    --essential-input-padding-y: {{ s.input_padding_y }}px;

    --essential-card-background-color: {{ s.card_background_color }};
    --essential-card-heading-color: {{ s.card_heading_color }};
    --essential-card-text-color: {{ s.card_text_color }};
    --essential-card-icon-color: {{ s.card_icon_color }};
    --essential-card-border-color: {{ s.card_border_color }};
    --essential-card-heading-font-size: {{ s.card_heading_font_size }}px;
    --essential-card-text-font-size: {{ s.card_text_font_size }}px;
    --essential-card-image-height: {{ s.card_image_height }}px;

    --essential-table-thead-background-color: {{ s.table_thead_background_color }};
    --essential-table-thead-text-color: {{ s.table_thead_text_color }};
    --essential-table-tbody-text-color: {{ s.table_tbody_text_color }};
    --essential-table-border-color: {{ s.table_border_color }};

    --essential-modal-background-color: {{ s.modal_background_color }};
    --essential-modal-text-color: {{ s.modal_text_color }};
    --essential-modal-icon-color: {{ s.modal_icon_color }};
    --essential-modal-icon-position-top: {{ s.modal_icon_position_top }}px;
    --essential-modal-icon-position-right: {{ s.modal_icon_position_right }}px;
    --essential-modal-heading-font-size: {{ s.modal_heading_font_size }}px;
    --essential-modal-text-font-size: {{ s.modal_text_font_size }}px;
  }

  #essential-loyalty-landing-page {
    background: var(--essential-page-background-color);
  }

  #essential-loyalty-landing-page .shopify-app-block {
      width: 100%;
  }

  {{ s.custom_css }}
</style>

<script>
  window.HoneyProxyPrefix = "{{ metafield.proxy_prefix }}";
  window.addEventListener('load', function () {
    [
      "https://unpkg.com/alpinejs",
      "https://cdn.jsdelivr.net/npm/@alpinejs/mask@3.x.x/dist/cdn.min.js"
    ].forEach(function (src) {
      var script = document.createElement('script');
      script.src = src;
      script.defer = true;
      document.body.appendChild(script);
    });
  });

  document.addEventListener('alpine:init', () => {
    Alpine.store('i18n', {
      locale: "{{ localization.language.iso_code }}",
      fallback: "{{ metafield.shop.primary_locale }}",
      translate: function(text, properties) {
        if (!text) return null;
        var translatedText = text[this.locale] || text[this.fallback] || text['en'];

        if (properties) {
          Object.keys(properties).forEach(function(key) {
            var searchStr = '{' + key + '}';
            var value = properties[key];
            while (translatedText.indexOf(searchStr) !== -1) {
              translatedText = translatedText.replace(searchStr, value);
            }
          });
        }

        return translatedText;
      }
    });

    Alpine.store('shop', {{ metafield | json }})

    Alpine.store('customer', {
      payload: {% if customer %}{{ customer_json }}{% else %}null{% endif %},
      authenticated() {
        return this.payload !== null;
      },
      activities() {
        if (!this.payload) return [];
        return this.payload.activities || [];
      },
      discounts() {
        if (!this.payload) return [];
        return this.payload.discounts || [];
      },
      points() {
        if (!this.payload) return 0;
        return this.payload.points;
      },
      refresh() {
        if (!this.payload) return;
        return fetch(HoneyProxyPrefix + '/proxy/api/customer.json')
          .then(response => response.json())
          .then(({ data }) => {
            this.payload = { ...data };
          });
      },
      actionCompleted(id) {
        if (!this.payload) return false;
        return (this.payload?.completed_action_ids || []).indexOf(id) !== -1;
      },
    })
  })
</script>

{% schema %}
{
  "name": "Landing Page Settings",
  "settings": [
    {
      "type": "header",
      "content": "General"
    },
    {
      "type": "text",
      "id": "heading_font_family",
      "label": "Heading Font Family"
    },
    {
      "type": "text",
      "id": "text_font_family",
      "label": "Text Font Family"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#000000"
    },
    {
      "type": "color_background",
      "id": "page_background_color",
      "label": "Page Background Color"
    },
    {
      "type": "range",
      "id": "page_max_width",
      "min": 400,
      "max": 2400,
      "step": 20,
      "unit": "px",
      "label": "Page Max Width",
      "default": 1200
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Border Radius",
      "default": 14
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "min": 10,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Heading Font Size",
      "default": 28
    },
    {
      "type": "range",
      "id": "text_font_size",
      "min": 10,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Text Font Size",
      "default": 14
    },
    {
      "type": "range",
      "id": "heading_font_size_mobile",
      "min": 10,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Heading Font Size (Mobile)",
      "default": 24
    },
    {
      "type": "range",
      "id": "text_font_size_mobile",
      "min": 10,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Text Font Size (Mobile)",
      "default": 14
    },
    {
      "type": "header",
      "content": "Button"
    },
    {
      "type": "color",
      "id": "button_background_color",
      "label": "Background Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_hover_background_color",
      "label": "Hover Background Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_hover_text_color",
      "label": "Hover Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_border_color",
      "label": "Border Color"
    },
    {
      "type": "range",
      "id": "button_font_size",
      "min": 10,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Font Size",
      "default": 14
    },
    {
      "type": "range",
      "id": "button_padding_y",
      "min": 0,
      "max": 40,
      "step": 1,
      "unit": "px",
      "label": "Vertical Padding",
      "default": 10
    },
    {
      "type": "range",
      "id": "button_padding_x",
      "min": 0,
      "max": 80,
      "step": 1,
      "unit": "px",
      "label": "Horizontal Padding",
      "default": 32
    },
    {
      "type": "header",
      "content": "Input"
    },
    {
      "type": "color",
      "id": "input_background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "input_text_color",
      "label": "Text Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "input_border_color",
      "label": "Border Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "input_font_size",
      "min": 10,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Font Size",
      "default": 14
    },
    {
      "type": "range",
      "id": "input_padding_x",
      "min": 0,
      "max": 40,
      "step": 1,
      "unit": "px",
      "label": "Vertical Padding",
      "default": 6
    },
    {
      "type": "range",
      "id": "input_padding_y",
      "min": 0,
      "max": 40,
      "step": 1,
      "unit": "px",
      "label": "Horizontal Padding",
      "default": 20
    },
    {
      "type": "header",
      "content": "Card"
    },
    {
      "type": "color",
      "id": "card_background_color",
      "label": "Card Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "card_heading_color",
      "label": "Card Heading Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "card_text_color",
      "label": "Card Text Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "card_icon_color",
      "label": "Card Icon Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "card_border_color",
      "label": "Card Border Color",
      "default": "#c6c6c6"
    },
    {
      "type": "range",
      "id": "card_heading_font_size",
      "min": 10,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Card Heading Font Size",
      "default": 16
    },
    {
      "type": "range",
      "id": "card_text_font_size",
      "min": 10,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Card Text Font Size",
      "default": 14
    },
    {
      "type": "range",
      "id": "card_image_height",
      "min": 10,
      "max": 200,
      "step": 10,
      "unit": "px",
      "label": "Card Image Height",
      "default": 50
    },
    {
      "type": "header",
      "content": "Table"
    },
    {
      "type": "color",
      "id": "table_thead_background_color",
      "label": "thead Background Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "table_thead_text_color",
      "label": "thead Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "table_tbody_text_color",
      "label": "tbody Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "table_border_color",
      "label": "Border Color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Modal"
    },
    {
      "type": "color",
      "id": "modal_background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "modal_text_color",
      "label": "Text Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "modal_icon_color",
      "label": "Icon Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "modal_icon_position_top",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Modal Close Icon Position Top",
      "default": 15
    },
    {
      "type": "range",
      "id": "modal_icon_position_right",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Modal Close Icon Position Right",
      "default": 15
    },
    {
      "type": "range",
      "id": "modal_heading_font_size",
      "min": 10,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Modal Heading Font Size",
      "default": 22
    },
    {
      "type": "range",
      "id": "modal_text_font_size",
      "min": 10,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Modal Text Font Size",
      "default": 14
    }
  ]
}
{% endschema %}