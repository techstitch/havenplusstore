{%- doc -%}
  This snippet is used to render a product card.
  It is used in the product block, featured product block, and the product card block.

  @param {product} product_resource - The product to render
  @param {boolean} [show_unit_price] - Whether to show the unit price
  @param {boolean} [show_sale_price_first] - Whether to show the sale price first
{%- enddoc -%}

{%- liquid
  assign show_unit_price = show_unit_price | default: false
  assign show_sale_price_first = show_sale_price_first | default: false
  assign selected_variant = product_resource.selected_or_first_available_variant
  assign price = selected_variant.price
  assign compare_at_price = selected_variant.compare_at_price

  assign show_compare_price = false
  if compare_at_price > price
    assign show_compare_price = true
  endif

  if product_resource == blank and request.design_mode
    assign price = 1999
  endif

  # Always use numeric-only prices (no currency text)
  assign price = price | money_without_currency
  assign compare_at_price = compare_at_price | money_without_currency
-%}

<div ref="priceContainer" class="price-wrapper">
  {% if show_sale_price_first == false and show_compare_price %}
    <s class="compare-at-price price-item">
      <span class="price-flex" style="text-decoration: line-through !important;">
        <img src="https://cdn.shopify.com/s/files/1/0688/2823/3773/files/UAE_Dirham_Symbol_svg.png?v=1756809609" 
             alt="AED" class="currency-icon" />
        {{ compare_at_price }}
      </span>
    </s>
  {% endif %}

  <span class="price price-item">
    <span class="price-flex">
      <img src="https://cdn.shopify.com/s/files/1/0688/2823/3773/files/UAE_Dirham_Symbol_svg.png?v=1756809609" 
           alt="AED" class="currency-icon" />
      {{ price | default: '&nbsp;' }}
    </span>
  </span>

  {% if show_sale_price_first == true and show_compare_price %}
    <s class="compare-at-price price-item">
      <span class="price-flex">
        <img src="https://cdn.shopify.com/s/files/1/0688/2823/3773/files/UAE_Dirham_Symbol_svg.png?v=1756809609" 
             alt="AED" class="currency-icon" />
        {{ compare_at_price }}
      </span>
    </s>
  {% endif %}

  {%- if selected_variant.unit_price and show_unit_price -%}
    {%- liquid
      assign unit_price = selected_variant.unit_price | money_without_currency
    -%}
    <div class="unit-price price-item">
      <span class="price-flex">
        <img src="https://cdn.shopify.com/s/files/1/0688/2823/3773/files/UAE_Dirham_Symbol_svg.png?v=1756809609" 
             alt="AED" class="currency-icon" />
        {{ unit_price }}
      </span>
      <span class="unit-price-separator">/</span>
      {{ selected_variant.unit_price_measurement.reference_value }}
      {{ selected_variant.unit_price_measurement.reference_unit }}
    </div>
  {%- endif -%}
</div>

<style>
.price-wrapper .price-item {
  display: inline-block;
}

.price-flex {
  display: inline-flex;
  align-items: center;
  gap: 4px; /* space between icon and number */
}

.price-wrapper .currency-icon {

    width: 15px !important;
    max-width: unset;
    height: 15px !important;
    min-height: unset !important;
    max-height: unset !important;
    vertical-align: middle;
    display: flex
;
    min-width: unset;}
.price-wrapper{
      display: flex
;
    flex-wrap: wrap;
    gap: 10px;
}
.price, .compare-at-price, .unit-price
 {
    min-width: fit-content;
    display: flex
        align-items: center;
;
}
</style>
